ReportDefinitions:
- reportName: MISEventLocalityWiseReport
  summary: Locality Wise report
  version: 1.0.0
  moduleName: prscp-services
  sourceColumns:
  - name: localityname
    label: report.prscp.localityname
    type: string
    source: prscp
    total: false
  - name: totalevents
    label: report.prscp.totalevents
    type: string
    source: prscp
    total: false
  - name: ongoingevents
    label: report.prscp.ongoingevents
    type: string
    source: prscp
    total: false
  - name: upcommingevents
    label: report.prscp.upcommingevents
    type: string
    source: prscp
    total: false
  - name: closedevents
    label: report.prscp.closedevents
    type: string
    source: prscp
    total: false
  - name: archivedevnets
    label: report.prscp.archivedevnets
    type: string
    source: prscp
    total: false
  additionalConfig:
    reportTitle: reports.prscp.MISSummaryReport.title
  query: select COALESCE(locality_name,'') localityname, count(1) totalevents, count((TO_TIMESTAMP(to_char(CURRENT_TIMESTAMP, 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD HH24:MI:SS') between TO_TIMESTAMP(concat(to_char(start_date, 'YYYY-MM-DD'),' ',start_time), 'YYYY-MM-DD HH24:MI:SS') and TO_TIMESTAMP(concat(to_char(end_date, 'YYYY-MM-DD'),' ',end_time), 'YYYY-MM-DD HH24:MI:SS')) or null) as ongoingevents, count((TO_TIMESTAMP(to_char(CURRENT_TIMESTAMP, 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD HH24:MI:SS') < TO_TIMESTAMP(concat(to_char(start_date, 'YYYY-MM-DD'),' ',start_time), 'YYYY-MM-DD HH24:MI:SS')) or null) as upcommingevents, count((TO_TIMESTAMP(to_char(CURRENT_TIMESTAMP, 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD HH24:MI:SS') > TO_TIMESTAMP(concat(to_char(end_date, 'YYYY-MM-DD'),' ',end_time), 'YYYY-MM-DD HH24:MI:SS') and event_status<>'CANCELLED') or null) as closedevents,	count((TO_TIMESTAMP(to_char(CURRENT_TIMESTAMP, 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD HH24:MI:SS') > TO_TIMESTAMP(concat(to_char(end_date, 'YYYY-MM-DD'),' ',end_time), 'YYYY-MM-DD HH24:MI:SS') and event_status<>'CANCELLED') or null) + count(event_status='CANCELLED' or null) as archivedevnets from egpr_event_detail where DATE(to_char(TO_TIMESTAMP(created_time / 1000),'yyyy-mm-dd')) between DATE($fromDate) and DATE($toDate) and COALESCE(locality_name,'') = case when $localityName<>'' then $localityName else COALESCE(locality_name,'') end group by tenant_id,module_code, COALESCE(locality_name,'')
